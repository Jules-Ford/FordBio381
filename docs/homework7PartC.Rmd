---
title: "Homework #7, Part C"
author: "Jules Ford"
date: "2023-03-08"
output: html_document
---

**This is the part of the homework that I have yet to finish!**
My current problems is that I'm having trouble figuring out what to generate for the new x and y variables, and how to place those in a new data frame.

Afterward I need to figure out how to re-plot the normal distribution with the real data from Part B (initially I chose to do a uniform distribution so I figured that out, but I haven't figured out how to re-plot the normal distribution).


**Problem 4**

So in Part B I found that the probability distribution that fit my data best was uniform. So, in order to generate new data, I'm going to need to use the `runif()` function. From the data in Part B, I found the maximum likelihood parameters for a normal distribution: `n=30`, `min=0.58`, `max=13.02`.

First I'll load in some packages:
```{r}
library(ggplot2) # for graphics
library(MASS) # for maximum likelihood estimation
```

Next, I'll plot the new randomized plot:
```{r}
# Need to generate the x and y variables. X is initial plant volume and Y is the density. I'm goint to place these data into a dataframe.

#newPlotDF <- data.frame("XInitialVol"=rnorm(n=30,min=0.58,max=13.02),"YDensity"=rnorm(30,min=.5,max=.8)) # For now I'm totally making up values for the Y variable. I'm not sure how to calculate them just yet so I want to make sure the code works


#newGraphData <- (runif(30, min=0.58, max=13.02)
#newGraph <- ggplot(data=newPlotDF, aes(x=newPlotDF$XInitialVol,y=newPlotDF$YDensity)) + geom_histogram(color="lightblue",fill="cornsilk",linewidth=0.2)

# The long story short is I'm not really sure how I'm supposed to produce the x and y variables with maximum likelihood estimation. I'm going to make sure to ask you about it in office hours!

```

Here I'll plot the graph from Part B with the real data:

```{r}
# This is code I pulled from Part B
voleData <- read.table("hwk7Data.csv",header=TRUE,sep=",")
p1 <- ggplot(data=voleData, aes(x=Initial.plant.volume..m3., y=..density..)) +
  geom_histogram(color="grey60",fill="cornsilk",linewidth=0.2)
print(p1)
normPars <- fitdistr(voleData$Initial.plant.volume..m3.,"normal")
normPars$estimate["mean"] 
meanML <- normPars$estimate["mean"]
sdML <- normPars$estimate["sd"]
xval <- seq(0,max(voleData$Initial.plant.volume..m3.),len=length(voleData$Initial.plant.volume..m3.))
stat <- stat_function(aes(x = xval, y = ..y..), fun = dnorm, colour="red", n = length(voleData$Initial.plant.volume..m3.), args = list(mean = meanML, sd = sdML))
p1 + stat


```

Question to answer: How do the two histogram profiles compare? Do you think the model is doing a good job of simulating realistic data that match your original measurements? Why or why not?

**Still need to answer this question when I figure out how to make the graph!**